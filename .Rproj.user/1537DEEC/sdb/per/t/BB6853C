{
    "contents" : "---\ntitle: \"Actividad 1 Unidad 3\"\nauthor: \"Carlos Antonio Lara Verduzco\"\ndate: \"Friday, September 04, 2015\"\noutput: html_document\n---\n\nLos datos que bienen en el archivo \"Datos y presentación de un modelo\" los introducimos en R y al graficarlos obtenemos:\n\n```{r}\nsetwd(\"~/Estadistica 3\")\nDatos <- read.table(\"datos.txt\", sep=\"\\t\")\nTiempo<- 0:300\nlibrary(\"ggplot2\")\nDat<- data.frame(Tiempo,Datos)\nlibrary(plyr)\nDat<- rename(Dat, c(\"V1\"=\"Datos\"))\nbp<- ggplot(data=Dat, aes(x=Tiempo, y=Datos, group=1)) +\n  geom_line(colour=\"blue\", linetype=\"solid\", size=1.5) +\n  geom_point(colour=\"red\", size=3, shape=21, fill=\"white\")\nbp + ggtitle(\"DATOS ORIGINALES A1 UNIDAD 3\") +\n  theme(plot.title = element_text(lineheight=.8, face=\"bold\"))\n\n\n\n\n```\n\nLos correlogramas correspondientes a $ACF$  y $PACF$  a los datos proporcionados en la actividad son:\n\n```{r, echo=FALSE}\nacf(Dat[,2], na.action = na.pass,  main = \"AFC_Autocorrelación\")\npacf(Dat[,2], na.action = na.pass,  main = \"PAFC Autocorrelación Parcial\")\n```\n\nEn el presente caso de esta base de datos, la serie de tiempo no es estacionaria, vemos que la variabilidad no es muy estable pues esta se incrementa al principio y luego disminuye considerablemente y presenta, en general, una tendencia positiva. Se aprecia también un cambio en la media con el tiempo por la tendencia positiva de los datos. Por ende, podemos considerar primeramente realizar un ajuste quizá logarítmico, es decir utilizar ajuste tipo Box-Cox. Sin embargo, la serie presenta datos negativos y no podremos calcular $\\lambda$ o $ln X_{t}$ para algunos valores de la variable aleatoria. En este caso, es mejor considerar el método de diferencias o datos diferenciados $Y_{t}= \\nabla X_{t}$ o $$\\nabla X_{t}= X_{t} - X_{t-1}$$ Con el software R esto es posible con la función \"diff()\" y el resultado al graficar los nuevos datos es:\n```{r}\nx1<- Dat[,2]\nx <- ts(x1)\nDat_Dif<-diff(x,1)\nts.plot(Dat_Dif, main = \"Datos Ajustados por Diferencial (1)\", xlab=\"Tiempo\", ylab=\"Datos\")\n\n```\n\n\nNótese ahora se tiene un comportamiento estacionario, de hecho, los datos se distribuyen alrededor de su media a lo largo del tiempo y dicha media es:\n\n```{r, echo=FALSE}\nMedia<-mean(Dat_Dif)\nMedia\n```\nPodemos ahora, presentar los  correlogramas de los nuevos datos:\n\n```{r, echo=FALSE}\nacf(Dat_Dif, na.action = na.pass,  main = \"AFC Autocorrelación\")\npacf(Dat_Dif, na.action = na.pass,  main = \"PAFC Autocorrelación Parcial\")\n```\n\nEn el modelo ajustado, los correlogramas muestran muchos picos no nulos. Vemos en ambos que se hacen completamente nulos después de Lag 4 aproximadamente. Podemos entonces proponer algún modelo $MA(4)$ o $AR(4)$ que modele los datos. Para ver cual se ajusta mejor, utilizamos en R el Criterio Akaike $(AIC)$; el modelo con un coeficiente  menor AIC será el más adecuado, esto es:\n```{r}\nAIC(arima(Dat_Dif,order = c(0,0,4)),arima(Dat_Dif,order = c(4,0,0)))\n\n```\n\n\nVéase como un $AR(4)$ parece ser mejor, sin embargo un $MA(4)$ no está lejos según el criterio empleado. Podemos entonces proponer un $AR(4)$ Ajustando el modelo a los datos se tiene:\nPrimero para saber qué modelo $AR(p)$ es mejor para nuestros datos, usamos la función $ar()$, esto nos dirá tanto el orden como los coeficientes del modelo mediante sus $MLE$. El resultado es:\n```{r}\nar(Dat_Dif)\n\n```\n\nVemos como nuestra predicción a partir de los correlogramas y el criterio $AIC$ concuerdan con lo arrojado por $ar()$ y vemos como incluso $\\sigma^{2}= 1$ con lo que el modelo para los datos sería:\n$$ X_{t} =  0.1026X_{t-1}+0.0367X_{t-2}+0.0846X_{t-3}+0.1178X_{t-4}+\\epsilon_{t}$$\nDonde $\\epsilon_{t}$ es ruido blanco donde $\\mu=0$ y $\\sigma^{2}= 1$.\nAhora, podemos hacer una simulación con el modelo obtenido para comparar los datos generados con los originales y ver si el comportamiento es similar. La gráfica de la simulación es:\n\n```{r}\nphi1<-0.1026 \nphi2<-0.036\nphi3<-0.0846\nphi4<-0.1178\nn<-300\n  \nmburn <- 300\n\nm <- n + mburn\n\ny <- {1:m}\ntiempo <- {1:n}\n\n# generar ruido blanco\neps <- rnorm(m)\n\ny[1] <- eps[1]\ny[2] <- eps[2]\ny[3] <- eps[3]\ny[4] <- eps[4]\n\n# generar proceso AR(1) en vec y[]\nfor(i in {5:m}){\n  \n  y[i] <- phi1*y[i-1] +phi2*y[i-2]+phi3*y[i-3]+phi4*y[i-4] + eps[i]}\n\n# tirar las primeras mburn observaciones\ny <- y[(mburn+1):m]\n  dat<- data.frame(tiempo,y)\n  \n  # graficar la serie de tiempo\n  bp<- ggplot(data=dat, aes(x=tiempo, y=y, group=1)) + \n    geom_line(colour=\"blue\", linetype=\"solid\", size=1.5) + \n    geom_point(colour=\"black\", size=3, shape=21, fill=\"white\")\n  \n  bp + ggtitle(\"METODO AUTOREGRESIVO\\n AR(4)\") + \n    theme(plot.title = element_text(lineheight=.8, face=\"bold\"))\n  # fin de la funcion\n\n```\n```{r, echo=FALSE}\nacf(y, na.action = na.pass,  main = \"AFC Autocorrelación\")\npacf(y, na.action = na.pass,  main = \"PAFC Autocorrelación Parcial\")\n```\nEn conclusión, hemos hecho un ajuste de los datos que teníamos originalmente de manera que la serie de tiempo fuera estacionaria. Para ello utilizamos datos diferenciados $Y_{t}= \\nabla X_{t}$ con $\\nabla X_{t}= X_{t} - X_{t-1}$ después graficamos y calculamos los correlogramas de los nuevos datos. De ellos nos servimos para poder estimar el tipo de modelo tipo $ARMA(p,q)$ que mejor se ajustara a la nueva serie estacionaria utilizando el software R. Concluimos de nuestro análisis que el modelo que representa nuestros datos es un $AR(4)$ y hemos hecho una simulación con éste donde nos damos cuenta que los datos generados y sus correlogramas presentan un comportamiento muy similar, lo cual nos dice, que efectivamente hemos hecho una buena estimación a partir de la transformación que hicimos con los datos originales.",
    "created" : 1441409485231.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2989046416",
    "id" : "BB6853C",
    "lastKnownWriteTime" : 1441415680,
    "path" : "~/Estadistica 3/Actividad 1 unidad 3.Rmd",
    "project_path" : "Actividad 1 unidad 3.Rmd",
    "properties" : {
        "tempName" : "Untitled3"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}